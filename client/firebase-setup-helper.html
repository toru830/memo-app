<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Firebase設定ヘルパー</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .step {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .step h2 {
            color: #1976d2;
            margin-top: 0;
        }
        .button {
            background: #1976d2;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            margin: 10px 10px 10px 0;
            text-decoration: none;
            display: inline-block;
        }
        .button:hover {
            background: #1565c0;
        }
        .code {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            margin: 10px 0;
        }
        .input-group {
            margin: 15px 0;
        }
        .input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        .input-group input {
            width: 100%;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
        }
        .success {
            background: #4caf50;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .warning {
            background: #ff9800;
            color: white;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .copy-btn {
            background: #4caf50;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
        .copy-btn:hover {
            background: #45a049;
        }
    </style>
</head>
<body>
    <h1>🔥 Firebase設定ヘルパー</h1>
    <p>このページでFirebase設定を簡単に完了できます</p>

    <!-- Step 1 -->
    <div class="step">
        <h2>ステップ1: Webアプリ登録</h2>
        <p>Firebase ConsoleでWebアプリを登録します</p>
        <a href="https://console.firebase.google.com/u/0/project/memo-app-7d6cf/settings/general" target="_blank" class="button">
            Firebase Consoleを開く
        </a>
        <div class="warning">
            ⚠️ 開いたページで以下を実行:
            <ol>
                <li>「マイアプリ」セクションまでスクロール</li>
                <li>「&lt;/&gt;」アイコンをクリック</li>
                <li>アプリのニックネーム: <strong>memo-web-app</strong></li>
                <li>「アプリを登録」をクリック</li>
                <li>表示される <code>firebaseConfig</code> の値を下に貼り付け</li>
            </ol>
        </div>
        <div class="input-group">
            <label>apiKey</label>
            <input type="text" id="apiKey" placeholder="AIzaSyC...">
        </div>
        <div class="input-group">
            <label>authDomain</label>
            <input type="text" id="authDomain" value="memo-app-7d6cf.firebaseapp.com">
        </div>
        <div class="input-group">
            <label>projectId</label>
            <input type="text" id="projectId" value="memo-app-7d6cf">
        </div>
        <div class="input-group">
            <label>storageBucket</label>
            <input type="text" id="storageBucket" value="memo-app-7d6cf.appspot.com">
        </div>
        <div class="input-group">
            <label>messagingSenderId</label>
            <input type="text" id="messagingSenderId" placeholder="123456789">
        </div>
        <div class="input-group">
            <label>appId</label>
            <input type="text" id="appId" placeholder="1:123456789:web:xxxxx">
        </div>
    </div>

    <!-- Step 2 -->
    <div class="step">
        <h2>ステップ2: Google認証設定</h2>
        <a href="https://console.firebase.google.com/u/0/project/memo-app-7d6cf/authentication/providers" target="_blank" class="button">
            Authentication設定を開く
        </a>
        <div class="warning">
            ⚠️ 開いたページで以下を実行:
            <ol>
                <li>「始める」をクリック（初回のみ）</li>
                <li>「Google」をクリック</li>
                <li>「有効にする」をON</li>
                <li>プロジェクト名: <strong>Memo App</strong></li>
                <li>サポートメール: あなたのGmail</li>
                <li>「保存」をクリック</li>
            </ol>
        </div>
    </div>

    <!-- Step 3 -->
    <div class="step">
        <h2>ステップ3: Firestore Database作成</h2>
        <a href="https://console.firebase.google.com/u/0/project/memo-app-7d6cf/firestore" target="_blank" class="button">
            Firestoreを開く
        </a>
        <div class="warning">
            ⚠️ 開いたページで以下を実行:
            <ol>
                <li>「データベースを作成」をクリック</li>
                <li>「本番環境モードで開始」を選択</li>
                <li>「次へ」をクリック</li>
                <li>ロケーション: <strong>asia-northeast1 (Tokyo)</strong></li>
                <li>「有効にする」をクリック</li>
            </ol>
        </div>
    </div>

    <!-- Step 4 -->
    <div class="step">
        <h2>ステップ4: セキュリティルール設定</h2>
        <a href="https://console.firebase.google.com/u/0/project/memo-app-7d6cf/firestore/rules" target="_blank" class="button">
            セキュリティルールを開く
        </a>
        <div class="warning">
            ⚠️ 以下のルールをコピーして貼り付け:
        </div>
        <div class="code" id="securityRules">rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
      match /memos/{memoId} {
        allow read, write: if request.auth != null && request.auth.uid == userId;
      }
    }
  }
}</div>
        <button class="copy-btn" onclick="copyRules()">ルールをコピー</button>
    </div>

    <!-- Step 5 -->
    <div class="step">
        <h2>ステップ5: 承認済みドメイン追加</h2>
        <a href="https://console.firebase.google.com/u/0/project/memo-app-7d6cf/authentication/settings" target="_blank" class="button">
            認証設定を開く
        </a>
        <div class="warning">
            ⚠️ 開いたページで以下を実行:
            <ol>
                <li>「承認済みドメイン」セクションまでスクロール</li>
                <li>「ドメインを追加」をクリック</li>
                <li>ドメイン: <strong>toru830.github.io</strong></li>
                <li>「追加」をクリック</li>
            </ol>
        </div>
    </div>

    <!-- Step 6 -->
    <div class="step">
        <h2>ステップ6: GitHub Secrets生成</h2>
        <p>ステップ1で入力した値からGitHub Secretsを自動生成します</p>
        <button class="button" onclick="generateSecrets()">GitHub Secrets情報を生成</button>
        <div id="secretsOutput"></div>
    </div>

    <!-- Step 7 -->
    <div class="step">
        <h2>ステップ7: GitHub Secretsを追加</h2>
        <a href="https://github.com/toru830/memo-app/settings/secrets/actions" target="_blank" class="button">
            GitHub Secretsを開く
        </a>
        <div class="warning">
            ⚠️ 上で生成された各Secretを追加:
            <ol>
                <li>「New repository secret」をクリック</li>
                <li>Name と Secret を入力</li>
                <li>「Add secret」をクリック</li>
                <li>全6つのSecretを追加</li>
            </ol>
        </div>
    </div>

    <script>
        function copyRules() {
            const rules = document.getElementById('securityRules').textContent;
            navigator.clipboard.writeText(rules).then(() => {
                alert('セキュリティルールをコピーしました！Firebase Consoleに貼り付けてください。');
            });
        }

        function generateSecrets() {
            const apiKey = document.getElementById('apiKey').value;
            const authDomain = document.getElementById('authDomain').value;
            const projectId = document.getElementById('projectId').value;
            const storageBucket = document.getElementById('storageBucket').value;
            const messagingSenderId = document.getElementById('messagingSenderId').value;
            const appId = document.getElementById('appId').value;

            if (!apiKey || !messagingSenderId || !appId) {
                alert('ステップ1の全ての値を入力してください！');
                return;
            }

            const secrets = [
                { name: 'VITE_FIREBASE_API_KEY', value: apiKey },
                { name: 'VITE_FIREBASE_AUTH_DOMAIN', value: authDomain },
                { name: 'VITE_FIREBASE_PROJECT_ID', value: projectId },
                { name: 'VITE_FIREBASE_STORAGE_BUCKET', value: storageBucket },
                { name: 'VITE_FIREBASE_MESSAGING_SENDER_ID', value: messagingSenderId },
                { name: 'VITE_FIREBASE_APP_ID', value: appId }
            ];

            let html = '<div class="success">✅ GitHub Secrets情報を生成しました！</div>';
            html += '<p>以下の各Secretを GitHub に追加してください:</p>';
            
            secrets.forEach(secret => {
                html += `
                    <div style="margin: 15px 0; padding: 10px; background: #f5f5f5; border-radius: 4px;">
                        <strong>Name:</strong> <code>${secret.name}</code><br>
                        <strong>Secret:</strong> <code>${secret.value}</code>
                        <button class="copy-btn" onclick="copyToClipboard('${secret.value}', '${secret.name}')">コピー</button>
                    </div>
                `;
            });

            document.getElementById('secretsOutput').innerHTML = html;
        }

        function copyToClipboard(text, name) {
            navigator.clipboard.writeText(text).then(() => {
                alert(`${name} の値をコピーしました！`);
            });
        }
    </script>
</body>
</html>
